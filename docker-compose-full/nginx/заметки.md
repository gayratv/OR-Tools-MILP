Пояснения:

limit_req_zone и limit_conn_zone объявляются вне блоков server.

Внутри server мы применяем limit_req/limit_conn. Подберите значения под свой трафик.

Простейшая фильтрация по User-Agent — это минимальная защита. Для серьёзной защиты лучше добавить WAF (например, nginx-modsecurity) или Cloudflare.


После правок:

docker compose exec -T nginx nginx -t && docker compose exec -T nginx nginx -s reload

Итого

Авто-renew + reload: через cron или systemd на хосте (просто и прозрачно).

Rate-limit/anti-bot: базовые ограничители RPS/соединений + фильтр user-agent.

Node.js остаётся недоступен снаружи напрямую (только через Nginx по 80/443).
=====================
docker compose exec -T nginx nginx -t && docker compose exec -T nginx nginx -s reload

docker compose exec -T nginx nginx -t

docker compose exec — запускает команду внутри уже работающего контейнера (в данном случае nginx).

-T — отключает псевдотерминал (TTY). Это удобно, если команда выполняется из скриптов или cron.

nginx -t — проверка конфигурации Nginx:

читает все конфиги из /etc/nginx/conf.d/ и /etc/nginx/nginx.conf;

сообщает, если есть ошибки или предупреждения;
не перезапускает Nginx, только валидирует.

nginx -s reload — мягкая перезагрузка:

Эта связка:

Проверяет синтаксис Nginx-конфигов внутри контейнера.

Если всё ок — перезагружает Nginx, подхватывая новые настройки (например, после изменения app.conf).
Если есть ошибка — reload не будет выполнен, Nginx продолжит работать со старой конфигурацией.
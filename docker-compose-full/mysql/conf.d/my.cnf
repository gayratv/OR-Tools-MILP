[mysqld]
# === БАЗОВОЕ ===
skip_name_resolve = ON
# кодировка по умолчанию
character-set-server = utf8mb4
collation-server     = utf8mb4_0900_ai_ci

# === ПАМЯТЬ (бережно) ===
# ~55–60% RAM под буфер пула InnoDB
innodb_buffer_pool_size      = 1100M
innodb_buffer_pool_instances = 1     # для небольших пулов выгоднее 1

# Пер-соединительные буферы: держим скромными (это *на соединение*)
sort_buffer_size      = 2M
join_buffer_size      = 2M
read_buffer_size      = 256K
read_rnd_buffer_size  = 512K
tmp_table_size        = 32M
max_heap_table_size   = 32M

# Соединения / очереди
max_connections = 60
back_log        = 80
thread_cache_size = 50

# === ДИСК/ЖУРНАЛИРОВАНИЕ ===
innodb_flush_method = O_DIRECT
innodb_flush_log_at_trx_commit = 1   # максимальная надёжность; можно 2 ради скорости
# Размер redo-журнала (MySQL 8+)
innodb_redo_log_capacity = 512M
innodb_io_capacity     = 200
innodb_io_capacity_max = 400

# === ЛОГИ ===
slow_query_log = ON
long_query_time = 2
#general_log = OFF

# === БЕЗОПАСНОСТЬ ===
# Для TLS раскомментируйте и добавьте сертификаты (см. прошлое сообщение)
require_secure_transport = ON
ssl-ca   = /certs/ca.pem
ssl-cert = /certs/server-cert.pem
ssl-key  = /certs/server-key.pem
